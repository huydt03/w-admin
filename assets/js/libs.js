const $=(()=>{function a(a,b){let c={};function d(b){Object.defineProperty(a,b,{set:function(a){if("function"==typeof a){let d=a.name||"__";c[b]=c[b]||{},c[b][d]=c[b][d]||[],c[b][d].push(a)}else throw"handle is not a function"}}),Object.defineProperty(a.handle,b,{get:function(){var a;return a=b,Object.freeze({fire(d){for(let e in c[a]){let b=c[a][e];for(let f in b)b[f](d)}},remove(b){b=b||"__",delete c[a][b]},clear(){c[a]={}}})}})}return a.handle={add(a){for(let b in a)d(a[b])},listen(b,c){d(b),a[b]=c}},!function(){for(let a in b)d(b[a])}(),a}function b(a){let c=JSON.parse(localStorage.getItem(a))??{},d=()=>{localStorage.setItem(a,JSON.stringify(c))},e={get:a=>c[a],set(a,b){c[a]=b,d()},remove(a){delete c[a],d()},destroy(){localStorage.removeItem(a)},clear(){c={},d()}},b={};return!function(){for(let a in e)Object.defineProperty(b,a,{get:function(){return e[a]}})}(),b}function c(){let c=["onBeforeAction","onAfterAction","onSuccess","onError"],b={},d,e=new XMLHttpRequest,f={get(a,b={},c=function(){}){h(a,b,"GET",c)},post(a,b={},c=function(){}){h(a,b,"POST",c)},put(a,b={},c=function(){}){h(a,b,"PUT",c)},delete(a,b={},c=function(){}){h(a,b,"DELETE",c)}};function g(c,d){var a,e=[];for(a in c)if(c.hasOwnProperty(a)){var f=d?d+"["+a+"]":a,b=c[a];e.push(null!==b&&"object"==typeof b?g(b,f):encodeURIComponent(f)+"="+encodeURIComponent(b))}return e.join("&")}function h(f,a={},h="GET",i=function(){}){d.onBeforeAction.fire(),e.onload=function(){if(4==this.readyState&&200==this.status){let a=JSON.parse(this.responseText);i(a),d.onSuccess.fire(a)}else d.onError.fire({status:this.status,message:this.responseText});d.onAfterAction.fire(this)},e.open(h,f,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded");let b=a._header;for(let c in b)e.setRequestHeader(c,b[c]);delete a._header,e.send(g(a))}return!function(){for(let e in d=a(b,c).handle,f)Object.defineProperty(b,e,{get:function(){return f[e]}})}(),b}function e(a={}){let b={required:(b,a)=>""!=a||"value is empty!",email:(b,a)=>/\S+@\S+\.\S+/.test(a)||"value is not an email!",between(a,e){let b=a[0],c=a[1],d=e.length;return b<=d&&d<=c||`value required form ${b} to ${c} character!`},min(b,c){let a=b[0];return a<=c.length||`value smaller ${a} character!`},max(b,c){let a=b[0];return a>=c.length||`value bigger ${a} character!`},numeric:(b,a)=>!isNaN(a)||"value is not a number!",num_min(b,c){let a=b[0];return a<=parseInt(c)||`value bigger ${a} required!`},num_max(b,c){let a=b[0];return a>=parseInt(c)||`value smaller ${a} required!`},num_between(b,a){let c=b[0],d=b[1];return c<=(a=parseInt(a))&&a<=d||`value bigger ${c} and smaller ${d} required!`},same:(a,b)=>document.getElementById(a[0]).value===b||`value not match ${a[0]}`,...a.validations};function c(e,f=null){let c=e.split("|");for(let g in c){let a=c[g].split(":")||null;if(!b[a[0]])continue;let h=a[1]?a[1].split(","):null,d=b[a[0]](h,f);if(!0!==d)return d}return!0}return Object.defineProperty({},"action",{get:function(){return c}})}function d(d,b={}){let f=["onBeforeValidate","onAfterValidate","onFieldValidated",],g,h=e({validations:b}),c={};function i(a){let d=a.onsubmit;if(a.onsubmit=function(b){!0!==k(a)?b.preventDefault():d(b)},a.elements)for(let b=0;b<a.elements.length;b++){let c=a.elements[b];c.onkeyup=c.onblur=function(){j(c)},c.onfocus=function(){g.onFieldValidated.fire({el:c,result:1})}}}function j(a){if(validates=a.getAttribute("validates")){let b=h.action(validates,a.value);return g.onFieldValidated.fire({el:a,result:b}),b}return!0}function k(a){g.onBeforeValidate.fire({form:a});let b=!0;for(let c=0;c<a.elements.length;c++){let d=j(a.elements[c]);!0!==d&&(b=d)}return g.onAfterValidate.fire({form:a,result:b}),b}return!function(){for(let b in g=a(c,f).handle,d)i(d[b]);Object.defineProperties(c,{add:{get:function(){return i}},validate:{get:function(){return k}}})}(),c}return{Ajax:c,createStorage:b,EventHandle:a,FormValidate:d}})()
